<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tropical Flow RadioTv Cristiana - Profesional</title>
<meta name="description" content="Tropical Flow RadioTv Cristiana ‚Äî M√∫sica, videos y mensajes para honrar a Dios.">
<style>
:root{--bg:#fffaf0;--accent:#2b6cb0;--muted:#6b7280;--card:#ffffff}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Inter,system-ui,Arial,Helvetica,sans-serif;background:var(--bg);color:#222;}
header{background:linear-gradient(90deg,#f7edd6,#fff);padding:22px 18px;border-bottom:1px solid #eee}
.container{max-width:1100px;margin:0 auto;padding:20px}
.brand{display:flex;gap:14px;align-items:center}
.logo{width:64px;height:64px;border-radius:12px;background:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent);box-shadow:0 6px 18px rgba(43,108,176,0.08)}
h1{margin:0;font-size:20px}
p.lead{margin:4px 0 0;color:var(--muted)}
main{display:grid;grid-template-columns:1fr;gap:18px;margin-top:18px}
.card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(16,24,40,0.04);border:1px solid #f0e9df}
.player{display:flex;flex-direction:column;gap:10px}
.controls{display:flex;gap:10px;align-items:center}
.btn{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}
.btn.secondary{background:transparent;color:var(--accent);border:1px solid var(--accent)}
.playlist{display:flex;flex-direction:column;gap:8px}
.track{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:linear-gradient(180deg,#fff,#fff);border:1px solid #f6efe6}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
.full{grid-column:1/-1}
footer{padding:18px;text-align:center;color:var(--muted);font-size:14px}
.floating-controls{position:fixed;bottom:20px;right:20px;background:rgba(43,108,176,0.9);padding:10px 14px;border-radius:12px;display:flex;gap:10px;z-index:999;}
.floating-controls button{padding:8px 12px;font-size:14px;}
@media(min-width:800px){main{grid-template-columns:2fr 1fr}}
</style>
</head>
<body>

<header>
<div class="container brand">
  <div class="logo">TF</div>
  <div>
    <h1>Tropical Flow RadioTv Cristiana</h1>
    <p class="lead">M√∫sica cristiana, predicaciones y oraci√≥n ‚Äî Dedicado a Dios üôè</p>
  </div>
</div>
</header>

<main class="container">
<section class="card">
<h2>Reproductor Profesional ‚Äî MP3 + Videos + En Vivo</h2>
<div class="player">
  <!-- STREAMING EN VIVO -->
  <audio id="stream" preload="none">
    <source src="https://your-stream-url.example/stream.mp3" type="audio/mpeg">
    Tu navegador no soporta audio en l√≠nea.
  </audio>
  <div class="controls">
    <button id="playStream" class="btn">Play Transmisi√≥n</button>
    <button id="stopStream" class="btn secondary">Detener</button>
    <div style="margin-left:auto;color:var(--muted)">Conectados: <span id="listeners">‚Äî</span></div>
  </div>

  <hr>

  <!-- PLAYLIST LOCAL MP3 -->
  <h3>Playlist MP3</h3>
  <input id="fileInput" type="file" accept="audio/*" multiple>
  <div class="playlist" id="playlistMP3"></div>

  <hr>

  <!-- PLAYLIST VIDEOS -->
  <h3>Videos YouTube</h3>
  <div id="videoContainer" style="aspect-ratio:16/9;overflow:hidden;border-radius:8px;border:1px solid #efe7d8">
    <div id="youtubePlayer"></div>
  </div>

</div>
</section>

<aside class="card">
<h3>Donar / Soporte</h3>
<form action="https://www.paypal.com/donate" method="post" target="_blank">
<input type="hidden" name="business" value="Cartagenajose1970@hotmail.com">
<input type="hidden" name="item_name" value="Donaci√≥n para Tropical Flow RadioTv Cristiana">
<input type="hidden" name="currency_code" value="USD">
<button type="submit" class="btn">Donar con PayPal</button>
</form>

<hr>

<h3>Horarios / Programaci√≥n</h3>
<ul>
<li><strong>06:00 - 09:00</strong> ‚Äî M√∫sica de alabanza y oraci√≥n matutina</li>
<li><strong>12:00 - 13:00</strong> ‚Äî Mensaje del d√≠a</li>
<li><strong>18:00 - 20:00</strong> ‚Äî M√∫sica cristiana contempor√°nea</li>
</ul>

<hr>

<h3>Contacto</h3>
<p>Correo: <a href="mailto:cartajo1970@gmail.com">cartajo1970@gmail.com</a></p>
<p>WhatsApp: <a href="https://wa.me/17873133929" target="_blank">+1 787-313-3929</a></p>
</aside>
</main>

<!-- CONTROLES FLOTANTES -->
<div class="floating-controls">
  <button id="btnPlayPause">Play/Pause</button>
  <button id="btnNext">Siguiente</button>
</div>

<footer>
<div class="container">¬© Tropical Flow RadioTv Cristiana ‚Äî Dedicado a Dios.</div>
</footer>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const stream=document.getElementById('stream');
const playBtn=document.getElementById('playStream');
const stopBtn=document.getElementById('stopStream');
const listeners=document.getElementById('listeners');

playBtn.addEventListener('click',()=>stream.play().catch(()=>alert('No se puede reproducir el stream.')));
stopBtn.addEventListener('click',()=>{stream.pause();stream.currentTime=0;});
listeners.innerText='‚Äî';

async function updateListeners(){
  try{
    const resp=await fetch('https://your-stream-url.example/status-json.xsl');
    const data=await resp.json();
    listeners.innerText=data.icestats.source[0].listeners || '‚Äî';
  }catch{listeners.innerText='‚Äî';}
}
setInterval(updateListeners,15000);
updateListeners();

// MP3 LOCAL
const fileInput=document.getElementById('fileInput');
const playlistEl=document.getElementById('playlistMP3');
let mp3Tracks=[];
let videoTracks=["A0BUNnIZYwY","B1CDEF2GH3I"]; // IDs de YouTube
let currentIndex=parseInt(localStorage.getItem('currentIndex'))||0;
let currentType=localStorage.getItem('currentType')||'mp3';
let localPlayer=new Audio();
let player;
let isPlayingVideo=false;

function renderMP3Playlist(){
  playlistEl.innerHTML='';
  mp3Tracks.forEach((t,i)=>{
    const div=document.createElement('div');
    div.className='track';
    div.innerHTML=`<div style="max-width:70%">${t.name}</div><div><button data-i="${i}" class="btn secondary">Reproducir</button></div>`;
    playlistEl.appendChild(div);
  });
}

fileInput.addEventListener('change',e=>{
  const files=Array.from(e.target.files);
  files.forEach(f=>mp3Tracks.push({name:f.name,url:URL.createObjectURL(f)}));
  renderMP3Playlist();
});

playlistEl.addEventListener('click',e=>{
  const btn=e.target.closest('button');
  if(!btn) return;
  const i=Number(btn.dataset.i);
  if(Number.isFinite(i)) playMedia(i,'mp3');
});

function playMedia(index,type){
  currentIndex=index;
  currentType=type;
  localStorage.setItem('currentIndex',currentIndex);
  localStorage.setItem('currentType',currentType);
  if(type==='mp3'){
    isPlayingVideo=false;
    player && player.pauseVideo && player.pauseVideo();
    localPlayer.src=mp3Tracks[index].url;
    localPlayer.play();
  }else{
    isPlayingVideo=true;
    localPlayer.pause();
    player.loadVideoById(videoTracks[index]);
    player.mute();
    setTimeout(()=>player.unMute(),500);
  }
}

function nextMedia(){
  if(currentType==='mp3'){
    currentIndex++;
    if(currentIndex>=mp3Tracks.length){
      if(videoTracks.length>0){currentType='video';currentIndex=0;}else{currentIndex=0;}
    }
    playMedia(currentIndex,currentType);
  }else{
    currentIndex++;
    if(currentIndex>=videoTracks.length){currentType='mp3';currentIndex=0;}
    playMedia(currentIndex,currentType);
  }
}

localPlayer.addEventListener('ended',()=>nextMedia());

// CONTROLES FLOTANTES
document.getElementById('btnPlayPause').addEventListener('click',()=>{
  if(isPlayingVideo){
    const state=player.getPlayerState();
    if(state===YT.PlayerState.PLAYING) player.pauseVideo(); else player.playVideo();
  }else{
    if(localPlayer.paused) localPlayer.play(); else localPlayer.pause();
  }
});

document.getElementById('btnNext').addEventListener('click',()=>nextMedia());

// YOUTUBE PLAYER
function onYouTubeIframeAPIReady(){
  player=new YT.Player('youtubePlayer',{
    height:'100%',
    width:'100%',
    videoId:videoTracks[0],
    playerVars:{autoplay:1,controls:1,mute:1},
    events:{'onReady':()=>{playMedia(currentIndex,currentType)},'onStateChange':onVideoStateChange}
  });
}

function onVideoStateChange(event){
  if(event.data===YT.PlayerState.ENDED) nextMedia();
}

// AUTOPLAY INICIAL
window.addEventListener('load',()=>{playMedia(currentIndex,currentType)});
</script>
</body>
</html>
